FROM ghcr.io/cross-rs/riscv64gc-unknown-linux-gnu:main
RUN apt-get update && apt-get install -y \
      curl make perl gcc g++ pkg-config clang \
 && rm -rf /var/lib/apt/lists/*
WORKDIR /tmp
RUN curl -LO https://www.openssl.org/source/openssl-3.0.15.tar.gz \
 && tar xf openssl-3.0.15.tar.gz \
 && cd openssl-3.0.15 \
 && CC="clang --target=riscv64-unknown-linux-gnu" \
    ./Configure linux-generic64 no-shared no-tests \
      --prefix=/opt/openssl-riscv64 \
 && make -j$(nproc) install_sw \
 && rm -rf /tmp/*
